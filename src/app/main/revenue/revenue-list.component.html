<div class="row">
    <div class="col-sm-12">
        <div class="card-box">
            <div class="row">
                <div class="col-lg-12">
                    <h4 class="m-t-0 header-title"><b>Doanh số</b></h4>

                    <!-- Header -->
                    <div class="row">
                        <div class="row">
                            <div class="col-md-3 col-sm-6 col-xs-12 ">
                                <ss-multiselect-dropdown [ngModelOptions]="{standalone: true}" [texts]="myTexts" [settings]="mySettings" [options]="revenueAllYearMonths"
                                    [(ngModel)]="revenueSelectedYearMonths" (ngModelChange)="onChange($event)"></ss-multiselect-dropdown>
                            </div>
                            <div class="col-md-3 col-sm-6 col-xs-12 ">
                                <ss-multiselect-dropdown [ngModelOptions]="{standalone: true}" [texts]="myTexts" [settings]="mySettings" [options]="customers"
                                    [(ngModel)]="selectCustomers"></ss-multiselect-dropdown>
                            </div>
                            <div class="col-md-2 col-sm-6 col-xs-12 ">
                                <div class=" contact-search m-b-30">
                                    <input type="text" id="search" class="form-control" placeholder="Nhập..." name="filter" (keyup.enter)="search()" [(ngModel)]="filter"
                                    />
                                    <button class="btn btn-white" (click)="loadData()"><i class="fa fa-search"></i></button>
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12 ">
                                <button class="btn btn-primary" type="button" (click)="search()">Tìm</button>
                                <button class="btn btn-danger" type="button" (click)="deleteMulti()">Xóa</button>

                                <a [routerLink]="['../../revenue/edit',0,'new']" class="btn btn-default waves-effect waves-light" data-animation="fadein"
                                    data-plugin="custommodal" data-overlaySpeed="200" data-overlayColor="#36404a"><i class="md md-add"></i> Thêm mới</a>

                            </div>
                        </div>

                    </div>

                    <!-- Header end-->
                    <!-- List -->
                    <button pButton type="button" (click)="toggle()" style="margin-bottom:10px" label="Toggle" icon="fa-list"></button>
                    <div class="table-responsive">
                        <p-dataTable [value]="revenues" rowGroupMode="subheader" groupField="Customer.Name" expandableRowGroups="true" [responsive]="true"
                            [stacked]="stacked">
                            <ng-template pTemplate="rowgroupheader" let-rowData>{{rowData.Customer.Name}}</ng-template>
                            <p-headerColumnGroup>
                                <p-row>
                                    <p-column header="Chọn" rowspan="3"></p-column>
                                    <p-column header="Thao tác" rowspan="3"></p-column>
                                    <p-column header="Tháng năm" rowspan="3"></p-column>
                                    <p-column header="Khách hàng" rowspan="3"></p-column>
                                    <p-column header="Công việc" rowspan="3"></p-column>
                                    <p-column header="Theo số liệu quotation/order" colspan="6"></p-column>

                                    <p-column header="Lũy kế" colspan="2"></p-column>

                                    <p-column header="Đã thực hiện  trong tháng (tạm tính)" colspan="6"></p-column>

                                    <p-column header="Kỳ sau" colspan="2"></p-column>

                                    <p-column header="Ghi chú" rowspan="3"></p-column>
                                </p-row>
                                <p-row>
                                    <p-column header="Thời gian thực hiện" colspan="2"></p-column>
                                    <p-column header="Tổng số MM(quản lý+phiên dịch)" rowspan="2"></p-column>
                                    <p-column header="ĐVT giá" rowspan="2"></p-column>
                                    <p-column header="Đơn giá" rowspan="2"></p-column>
                                    <p-column header="Thành tiền($)" rowspan="2"></p-column>

                                    <p-column header="Tổng số MM" rowspan="2"></p-column>
                                    <p-column header="Thành tiền($)" rowspan="2"></p-column>

                                    <p-column header="Số công LTV" rowspan="2"></p-column>
                                    <p-column header="Số công PD" rowspan="2"></p-column>
                                    <p-column header="Số công QL" rowspan="2"></p-column>
                                    <p-column header="Tổng MM" rowspan="2"></p-column>
                                    <p-column header="Thành tiền($)" rowspan="2"></p-column>
                                    <p-column header="Thành tiền(VND)" rowspan="2"></p-column>

                                    <p-column header="Tổng số MM" rowspan="2"></p-column>
                                    <p-column header="Thành tiền($)" rowspan="2"></p-column>

                                </p-row>
                                <p-row>
                                    <p-column header="Ngày start"></p-column>
                                    <p-column header="Ngày end"></p-column>
                                </p-row>
                            </p-headerColumnGroup>

                            <p-column></p-column>
                            <p-column></p-column>

                            <p-column field="ReportYearMonth" [sortable]="true">
                                <ng-template let-col let-data="rowData" pTemplate="body">
                                    <span>{{data[col.field]| date:'yyyy/MM'}}</span>
                                </ng-template>
                            </p-column>
                            <p-column field="Customer.Name"></p-column>
                            <p-column field="ProjectContent">
                                <ng-template let-col let-data="rowData" pTemplate="body">
                                    <span>{{data[col.field]}}</span>
                                </ng-template>
                            </p-column>

                            <p-column field="OrderStartDate" [sortable]="true">
                                <ng-template let-col let-data="rowData" pTemplate="body">
                                    <span>{{data[col.field]| date:'MM/dd'}}</span>
                                </ng-template>
                            </p-column>
                            <p-column field="OrderEndDate" [sortable]="true">
                                <ng-template let-col let-data="rowData" pTemplate="body">
                                    <span>{{data[col.field]| date:'MM/dd'}}</span>
                                </ng-template>
                            </p-column>

                            <p-column field="OrderProjectSumMM"></p-column>
                            <p-column field="OrderUnitMasterDetailID"></p-column>
                            <p-column field="OrderPrice">
                                <ng-template let-col let-data="rowData" pTemplate="item">
                                    <span *ngIf="data.OrderUnitMasterDetailID ===2">{{data[col.field]| currency:'USD':true:'1.0-0'}}</span>
                                    <span *ngIf="data.OrderUnitMasterDetailID ===3">{{data[col.field]| currency:'JPY':true:'1.0-0'}}</span>
                                </ng-template>
                            </p-column>

                            <p-column field="OrderPriceToUsd">
                                <ng-template let-col let-data="rowData" pTemplate="item">
                                    <span>{{data[col.field]| currency:'USD':true:'1.0-0'}}</span>
                                </ng-template>
                            </p-column>

                            <p-column field="AccPreMonthSumMM"></p-column>
                            <p-column field="AccPreMonthSumToUsd"></p-column>
                            <p-column field="InMonthDevMM"></p-column>
                            <p-column field="InMonthTransMM"></p-column>
                            <p-column field="InMonthManagementMM"></p-column>
                            <p-column field="InMonthSumMM"></p-column>
                            <p-column field="InMonthToUsd"></p-column>
                            <p-column field="InMonthToVnd"></p-column>
                            <p-column field="NextMonthMM"></p-column>
                            <p-column field="NextMonthToUsd"></p-column>
                            <p-column field="thisYearProfit"></p-column>
                            <p-column field="Note"></p-column>

                            <ng-template pTemplate="rowgroupfooter" let-data>
                                <td colspan="3" style="text-align:right">Total InMonthSumMM</td>
                                <td>{{calculateGroupTotal(data['CustomerID']) }}</td>
                            </ng-template>
                            <p-footerColumnGroup>
                                <p-row>
                                    <p-column footer="Tổng MM LT lần này:" colspan="3"></p-column>
                                    <p-column footer="$506,202"></p-column>
                                    <p-column footer="$531,020"></p-column>
                                </p-row>
                            </p-footerColumnGroup>
                        </p-dataTable>
                    </div>
                    <!-- List end-->
                </div>

            </div>
        </div>
    </div>
</div>